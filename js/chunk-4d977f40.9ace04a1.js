(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d977f40"],{"02de":function(t,i,e){"use strict";function s(t){return"none"===window.getComputedStyle(t).display||null===t.offsetParent}e.d(i,"a",(function(){return s}))},"0339":function(t,i,e){"use strict";e.r(i);var s,a=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"user-history"},[s("div",{staticClass:"com-title-bar"},[s("div",{staticClass:"box"},[s("div",{staticClass:"back",on:{click:t.$routerBack}}),s("div",{staticClass:"title"},[t._v("历史记录")]),s("div",{staticClass:"action"},[s("div",{staticClass:"button",on:{click:t.clearHandel}},[t._v(t._s(t.clear.text))])])])]),t.view.display?s("div",{staticClass:"data"},[s("div",{staticClass:"tabs"},[s("van-tabs",{attrs:{"lazy-render":"",swipeable:"",animated:"",sticky:"",color:"#FFEA03","line-width":44,"line-height":2,border:!1},model:{value:t.tabs.active,callback:function(i){t.$set(t.tabs,"active",i)},expression:"tabs.active"}},[s("van-tab",{attrs:{title:"今天",name:"today"}},[t.history.today.empty?s("div",{staticClass:"empty"},[s("div",{staticClass:"image"},[s("img",{attrs:{src:e("1418"),alt:""}})]),s("div",{staticClass:"text"},[t._v("暂无观看记录")])]):t._e(),s("div",{staticClass:"box"},[s("van-list",{attrs:{finished:t.history.today.finished,"finished-text":""},on:{load:t.initToday},model:{value:t.history.today.loading,callback:function(i){t.$set(t.history.today,"loading",i)},expression:"history.today.loading"}},t._l(t.history.today.data,(function(i,e){return s("div",{key:e,staticClass:"item"},[s("div",{staticClass:"video",on:{click:function(e){return t.videoHandel(i.video.uuid)}}},[s("div",{staticClass:"image"},[s("img",{attrs:{src:i.video.thumbnail,alt:""}})]),s("div",{staticClass:"info"},[s("div",{staticClass:"title"},[t._v("\n                                            "+t._s(i.video.title)+"\n                                        ")]),s("div",{staticClass:"star"},[s("div",{staticClass:"ico"},[s("van-icon",{attrs:{name:"star",color:"#FFEA03"}})],1),s("div",{staticClass:"text"},[t._v(t._s(i.video.star))])])])])])})),0)],1)]),s("van-tab",{attrs:{title:"七天",name:"week"}},[t.history.week.empty?s("div",{staticClass:"empty"},[s("div",{staticClass:"image"},[s("img",{attrs:{src:e("1418"),alt:""}})]),s("div",{staticClass:"text"},[t._v("暂无观看记录")])]):t._e(),s("div",{staticClass:"box"},[s("van-list",{attrs:{finished:t.history.week.finished,"finished-text":""},on:{load:t.initWeek},model:{value:t.history.week.loading,callback:function(i){t.$set(t.history.week,"loading",i)},expression:"history.week.loading"}},t._l(t.history.week.data,(function(i,e){return s("div",{key:e,staticClass:"item"},[s("div",{staticClass:"video",on:{click:function(e){return t.videoHandel(i.video.uuid)}}},[s("div",{staticClass:"image"},[s("img",{attrs:{src:i.video.thumbnail,alt:""}})]),s("div",{staticClass:"info"},[s("div",{staticClass:"title"},[t._v("\n                                            "+t._s(i.video.title)+"\n                                        ")]),s("div",{staticClass:"star"},[s("div",{staticClass:"ico"},[s("van-icon",{attrs:{name:"star",color:"#FFEA03"}})],1),s("div",{staticClass:"text"},[t._v(t._s(i.video.star))])])])])])})),0)],1)]),s("van-tab",{attrs:{title:"更早",name:"early"}},[t.history.early.empty?s("div",{staticClass:"empty"},[s("div",{staticClass:"image"},[s("img",{attrs:{src:e("1418"),alt:""}})]),s("div",{staticClass:"text"},[t._v("暂无观看记录")])]):t._e(),s("div",{staticClass:"box"},[s("van-list",{attrs:{finished:t.history.early.finished,"finished-text":""},on:{load:t.initEarly},model:{value:t.history.early.loading,callback:function(i){t.$set(t.history.early,"loading",i)},expression:"history.early.loading"}},t._l(t.history.early.data,(function(i,e){return s("div",{key:e,staticClass:"item"},[s("div",{staticClass:"video",on:{click:function(e){return t.videoHandel(i.video.uuid)}}},[s("div",{staticClass:"image"},[s("img",{attrs:{src:i.video.thumbnail,alt:""}})]),s("div",{staticClass:"info"},[s("div",{staticClass:"title"},[t._v("\n                                            "+t._s(i.video.title)+"\n                                        ")]),s("div",{staticClass:"star"},[s("div",{staticClass:"ico"},[s("van-icon",{attrs:{name:"star",color:"#FFEA03"}})],1),s("div",{staticClass:"text"},[t._v(t._s(i.video.star))])])])])])})),0)],1)])],1)],1)]):t._e()])},n=[],r=e("bd86"),o=(e("2994"),e("2bdd")),l=(e("bda7"),e("5e46")),c=(e("da3c"),e("0b33")),d=(e("7f7f"),e("c3a6"),e("ad06")),h={components:(s={},Object(r["a"])(s,d["a"].name,d["a"]),Object(r["a"])(s,c["a"].name,c["a"]),Object(r["a"])(s,l["a"].name,l["a"]),Object(r["a"])(s,o["a"].name,o["a"]),s),data:function(){return{view:{display:!0},tabs:{active:"today"},clear:{text:"清空"},history:{today:{data:[],loading:!1,finished:!1,empty:!1,page:1},week:{data:[],loading:!1,finished:!1,empty:!1,page:1},early:{data:[],loading:!1,finished:!1,empty:!1,page:1}}}},beforeRouteEnter:function(t,i,e){t.meta.Load=!1,"/video/index"!==i.path&&!0===t.meta.Create&&(t.meta.Load=!0),e()},beforeRouteLeave:function(t,i,e){i.meta.Create=!0,"/video/index"!==t.path&&(this.view.display=!1),e()},activated:function(){var t=this;this.$route.meta.Load&&(setTimeout((function(){t.view.display=!0}),10),this.tabs.active="today",this.history={today:{data:[],loading:!1,finished:!1,empty:!1,page:1},week:{data:[],loading:!1,finished:!1,empty:!1,page:1},early:{data:[],loading:!1,finished:!1,empty:!1,page:1}})},mounted:function(){},methods:{initToday:function(){var t=this;this.$axios.get("/api/app/user/history/data",{period:0,page:this.history.today.page}).then((function(i){var e=i.data.code,s=i.data.result;200===e&&(t.history.today.page++,t.history.today.page>s.last_page&&(t.history.today.finished=!0),t.history.today.data=t.history.today.data.concat(s.data),0===t.history.today.data.length&&(t.history.today.empty=!0),t.history.today.loading=!1)}))},initWeek:function(){var t=this;this.$axios.get("/api/app/user/history/data",{period:7,page:this.history.week.page}).then((function(i){var e=i.data.code,s=i.data.result;200===e&&(t.history.week.page++,t.history.week.page>s.last_page&&(t.history.week.finished=!0),t.history.week.data=t.history.week.data.concat(s.data),0===t.history.week.data.length&&(t.history.week.empty=!0),t.history.week.loading=!1)}))},initEarly:function(){var t=this;this.$axios.get("/api/app/user/history/data",{period:90,page:this.history.early.page}).then((function(i){var e=i.data.code,s=i.data.result;200===e&&(t.history.early.page++,t.history.early.page>s.last_page&&(t.history.early.finished=!0),t.history.early.data=t.history.early.data.concat(s.data),0===t.history.early.data.length&&(t.history.early.empty=!0),t.history.early.loading=!1)}))},videoHandel:function(t){this.$router.push("/video/index?uuid="+t)},clearHandel:function(){var t=this;this.$dialog.confirm({title:"提示",message:"确定清空所有历史记录?"}).then((function(){t.$axios.post("/api/app/user/history/clear").then((function(i){var e=i.data.code;200===e&&(t.$toast.success("清空成功"),t.history.today.data=[],t.history.today.empty=!0,t.history.week.data=[],t.history.week.empty=!0,t.history.early.data=[],t.history.early.empty=!0)}))}))}}},u=h,f=(e("53c8"),e("2877")),v=Object(f["a"])(u,a,n,!1,null,"480c3c96",null);i["default"]=v.exports},"0b33":function(t,i,e){"use strict";var s=e("c31d"),a=e("d282"),n=e("9884"),r=e("48f4"),o=Object(a["a"])("tab"),l=o[0],c=o[1];i["a"]=l({mixins:[Object(n["a"])("vanTabs")],props:Object(s["a"])({},r["c"],{name:[Number,String],title:String,disabled:Boolean}),data:function(){return{inited:!1}},computed:{computedName:function(){return this.name||this.index},isActive:function(){return this.computedName===this.parent.currentName}},watch:{"parent.currentIndex":function(){this.inited=this.inited||this.isActive},title:function(){this.parent.setLine()}},mounted:function(){this.slots("title")&&this.parent.renderTitle(this.$refs.title,this.index)},render:function(t){var i=this.slots,e=this.isActive,s=this.inited||!this.parent.lazyRender,a=[s?i():t()];return i("title")&&a.push(t("div",{ref:"title"},[i("title")])),this.parent.animated?t("div",{attrs:{role:"tabpanel","aria-hidden":!e},class:c("pane-wrapper",{inactive:!e})},[t("div",{class:c("pane")},[a])]):t("div",{directives:[{name:"show",value:e}],attrs:{role:"tabpanel"},class:c("pane")},[a])}})},1418:function(t,i,e){t.exports=e.p+"img/empty.1efdba7f.png"},2994:function(t,i,e){"use strict";e("68ef"),e("c0c2")},"2bdd":function(t,i,e){"use strict";var s=e("d282"),a=e("02de"),n=e("5fbe"),r=e("a8c1"),o=e("543e"),l=Object(s["a"])("list"),c=l[0],d=l[1],h=l[2];i["a"]=c({mixins:[Object(n["a"])((function(t){this.scroller||(this.scroller=Object(r["c"])(this.$el)),t(this.scroller,"scroll",this.check)}))],model:{prop:"loading"},props:{error:Boolean,loading:Boolean,finished:Boolean,errorText:String,loadingText:String,finishedText:String,immediateCheck:{type:Boolean,default:!0},offset:{type:Number,default:300},direction:{type:String,default:"down"}},mounted:function(){this.immediateCheck&&this.check()},watch:{loading:"check",finished:"check"},methods:{check:function(){var t=this;this.$nextTick((function(){if(!(t.loading||t.finished||t.error)){var i,e=t.$el,s=t.scroller,n=t.offset,r=t.direction;i=s.getBoundingClientRect?s.getBoundingClientRect():{top:0,bottom:s.innerHeight};var o=i.bottom-i.top;if(!o||Object(a["a"])(e))return!1;var l=!1,c=t.$refs.placeholder.getBoundingClientRect();l="up"===r?c.top-i.top<=n:c.bottom-i.bottom<=n,l&&(t.$emit("input",!0),t.$emit("load"))}}))},clickErrorText:function(){this.$emit("update:error",!1),this.check()}},render:function(){var t=arguments[0],i=t("div",{ref:"placeholder",class:d("placeholder")});return t("div",{class:d(),attrs:{role:"feed","aria-busy":this.loading}},["down"===this.direction?this.slots():i,this.loading&&t("div",{class:d("loading"),key:"loading"},[this.slots("loading")||t(o["a"],{attrs:{size:"16"}},[this.loadingText||h("loading")])]),this.finished&&this.finishedText&&t("div",{class:d("finished-text")},[this.finishedText]),this.error&&this.errorText&&t("div",{on:{click:this.clickErrorText},class:d("error-text")},[this.errorText]),"up"===this.direction?this.slots():i])}})},4598:function(t,i,e){"use strict";(function(t){e.d(i,"a",(function(){return l}));var s=e("a142"),a=Date.now();function n(t){var i=Date.now(),e=Math.max(0,16-(i-a)),s=setTimeout(t,e);return a=i+e,s}var r=s["d"]?t:window,o=r.requestAnimationFrame||n;r.cancelAnimationFrame||r.clearTimeout;function l(t){return o.call(r,t)}}).call(this,e("c8ba"))},"53c8":function(t,i,e){"use strict";var s=e("ccc3"),a=e.n(s);a.a},"5e46":function(t,i,e){"use strict";var s=e("d282"),a=e("a142"),n=e("ea8e"),r=e("4598");function o(t,i,e){var s=0,a=t.scrollLeft,n=0===e?1:Math.round(1e3*e/16);function o(){t.scrollLeft+=(i-a)/n,++s<n&&Object(r["a"])(o)}o()}var l=e("48f4"),c=e("02de"),d=e("9884"),h=e("5fbe"),u=e("b1d2"),f=e("a8c1"),v=Object(s["a"])("tab")[1],p={props:{type:String,color:String,title:String,isActive:Boolean,ellipsis:Boolean,disabled:Boolean,scrollable:Boolean,activeColor:String,inactiveColor:String,swipeThreshold:Number},computed:{style:function(){var t={},i=this.color,e=this.isActive,s="card"===this.type;i&&s&&(t.borderColor=i,this.disabled||(e?t.backgroundColor=i:t.color=i));var a=e?this.activeColor:this.inactiveColor;return a&&(t.color=a),this.scrollable&&this.ellipsis&&(t.flexBasis=88/this.swipeThreshold+"%"),t}},methods:{onClick:function(){this.$emit("click")},renderTitle:function(t){var i=this.$refs.title;i.innerHTML="",i.appendChild(t)}},render:function(){var t=arguments[0];return t("div",{attrs:{role:"tab","aria-selected":this.isActive},class:v({active:this.isActive,disabled:this.disabled,complete:!this.ellipsis}),style:this.style,on:{click:this.onClick}},[t("span",{ref:"title",class:{"van-ellipsis":this.ellipsis}},[this.title])])}},y=e("c31d"),m=e("3875"),b=Object(s["a"])("tabs"),g=b[0],x=b[1],C=50,k=g({mixins:[m["a"]],props:{count:Number,duration:Number,animated:Boolean,swipeable:Boolean,currentIndex:Number},computed:{style:function(){if(this.animated)return{transform:"translate3d("+-1*this.currentIndex*100+"%, 0, 0)",transitionDuration:this.duration+"s"}},listeners:function(){if(this.swipeable)return{touchstart:this.touchStart,touchmove:this.touchMove,touchend:this.onTouchEnd,touchcancel:this.onTouchEnd}}},methods:{onTouchEnd:function(){var t=this.direction,i=this.deltaX,e=this.currentIndex;"horizontal"===t&&this.offsetX>=C&&(i>0&&0!==e?this.$emit("change",e-1):i<0&&e!==this.count-1&&this.$emit("change",e+1))},renderChildren:function(){var t=this.$createElement;return this.animated?t("div",{class:x("track"),style:this.style},[this.slots()]):this.slots()}},render:function(){var t=arguments[0];return t("div",{class:x("content",{animated:this.animated}),on:Object(y["a"])({},this.listeners)},[this.renderChildren()])}}),w=Object(s["a"])("sticky"),$=w[0],T=w[1],I=$({mixins:[Object(h["a"])((function(t){this.scroller||(this.scroller=Object(f["c"])(this.$el)),t(this.scroller,"scroll",this.onScroll,!0),this.onScroll()}))],props:{zIndex:Number,container:null,offsetTop:{type:Number,default:0}},data:function(){return{fixed:!1,height:0,transform:0}},computed:{style:function(){if(this.fixed){var t={};return Object(a["b"])(this.zIndex)&&(t.zIndex=this.zIndex),this.offsetTop&&this.fixed&&(t.top=this.offsetTop+"px"),this.transform&&(t.transform="translate3d(0, "+this.transform+"px, 0)"),t}}},methods:{onScroll:function(){var t=this;this.height=this.$el.offsetHeight;var i=this.container,e=this.offsetTop,s=Object(f["d"])(window),a=Object(f["a"])(this.$el),n=function(){t.$emit("scroll",{scrollTop:s,isFixed:t.fixed})};if(i){var r=a+i.offsetHeight;if(s+e+this.height>r){var o=this.height+s-r;return o<this.height?(this.fixed=!0,this.transform=-(o+e)):this.fixed=!1,void n()}}s+e>a?(this.fixed=!0,this.transform=0):this.fixed=!1,n()}},render:function(){var t=arguments[0],i=this.fixed,e={height:i?this.height+"px":null};return t("div",{style:e},[t("div",{class:T({fixed:i}),style:this.style},[this.slots()])])}}),j=Object(s["a"])("tabs"),O=j[0],S=j[1];i["a"]=O({mixins:[Object(d["b"])("vanTabs"),Object(h["a"])((function(t){t(window,"resize",this.setLine,!0)}))],model:{prop:"active"},props:{color:String,sticky:Boolean,animated:Boolean,swipeable:Boolean,background:String,lineWidth:[Number,String],lineHeight:[Number,String],titleActiveColor:String,titleInactiveColor:String,type:{type:String,default:"line"},active:{type:[Number,String],default:0},border:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},duration:{type:Number,default:.3},offsetTop:{type:Number,default:0},lazyRender:{type:Boolean,default:!0},swipeThreshold:{type:Number,default:4}},data:function(){return{position:"",currentIndex:null,lineStyle:{backgroundColor:this.color}}},computed:{scrollable:function(){return this.children.length>this.swipeThreshold||!this.ellipsis},navStyle:function(){return{borderColor:this.color,background:this.background}},currentName:function(){var t=this.children[this.currentIndex];if(t)return t.computedName}},watch:{color:"setLine",active:function(t){t!==this.currentName&&this.setCurrentIndexByName(t)},children:function(){var t=this;this.setCurrentIndexByName(this.currentName||this.active),this.setLine(),this.$nextTick((function(){t.scrollIntoView(!0)}))},currentIndex:function(){this.scrollIntoView(),this.setLine(),this.stickyFixed&&Object(f["e"])(Math.ceil(Object(f["a"])(this.$el)-this.offsetTop))}},mounted:function(){this.onShow()},activated:function(){this.onShow(),this.setLine()},methods:{onShow:function(){var t=this;this.$nextTick((function(){t.inited=!0,t.scrollIntoView(!0)}))},setLine:function(){var t=this,i=this.inited;this.$nextTick((function(){var e=t.$refs.titles;if(e&&e[t.currentIndex]&&"line"===t.type&&!Object(c["a"])(t.$el)){var s=e[t.currentIndex].$el,r=t.lineWidth,o=t.lineHeight,l=Object(a["b"])(r)?r:s.offsetWidth/2,d=s.offsetLeft+s.offsetWidth/2,h={width:Object(n["a"])(l),backgroundColor:t.color,transform:"translateX("+d+"px) translateX(-50%)"};if(i&&(h.transitionDuration=t.duration+"s"),Object(a["b"])(o)){var u=Object(n["a"])(o);h.height=u,h.borderRadius=u}t.lineStyle=h}}))},setCurrentIndexByName:function(t){var i=this.children.filter((function(i){return i.computedName===t})),e=(this.children[0]||{}).index||0;this.setCurrentIndex(i.length?i[0].index:e)},setCurrentIndex:function(t){if(t=this.findAvailableTab(t),Object(a["b"])(t)&&t!==this.currentIndex){var i=null!==this.currentIndex;this.currentIndex=t,this.$emit("input",this.currentName),i&&this.$emit("change",this.currentName,this.children[t].title)}},findAvailableTab:function(t){var i=t<this.currentIndex?-1:1;while(t>=0&&t<this.children.length){if(!this.children[t].disabled)return t;t+=i}},onClick:function(t){var i=this.children[t],e=i.title,s=i.disabled,a=i.computedName;s?this.$emit("disabled",a,e):(this.setCurrentIndex(t),this.$emit("click",a,e))},scrollIntoView:function(t){var i=this.$refs.titles;if(this.scrollable&&i&&i[this.currentIndex]){var e=this.$refs.nav,s=i[this.currentIndex].$el,a=s.offsetLeft-(e.offsetWidth-s.offsetWidth)/2;o(e,a,t?0:this.duration)}},renderTitle:function(t,i){var e=this;this.$nextTick((function(){e.$refs.titles[i].renderTitle(t)}))},onScroll:function(t){this.stickyFixed=t.isFixed,this.$emit("scroll",t)}},render:function(){var t,i=this,e=arguments[0],s=this.type,a=this.ellipsis,n=this.animated,r=this.scrollable,o=this.children.map((function(t,n){return e(p,{ref:"titles",refInFor:!0,attrs:{type:s,title:t.title,color:i.color,isActive:n===i.currentIndex,ellipsis:a,disabled:t.disabled,scrollable:r,activeColor:i.titleActiveColor,inactiveColor:i.titleInactiveColor,swipeThreshold:i.swipeThreshold},on:{click:function(){i.onClick(n),Object(l["b"])(t.$router,t)}}})})),c=e("div",{ref:"wrap",class:[S("wrap",{scrollable:r}),(t={},t[u["d"]]="line"===s&&this.border,t)]},[e("div",{ref:"nav",attrs:{role:"tablist"},class:S("nav",[s]),style:this.navStyle},[this.slots("nav-left"),o,"line"===s&&e("div",{class:S("line"),style:this.lineStyle}),this.slots("nav-right")])]);return e("div",{class:S([s])},[this.sticky?e(I,{attrs:{container:this.$el,offsetTop:this.offsetTop},on:{scroll:this.onScroll}},[c]):c,e(k,{attrs:{count:this.children.length,animated:n,duration:this.duration,swipeable:this.swipeable,currentIndex:this.currentIndex},on:{change:this.setCurrentIndex}},[this.slots()])])}})},ae9e:function(t,i,e){},b807:function(t,i,e){},bda7:function(t,i,e){"use strict";e("68ef"),e("ae9e"),e("b807")},c0c2:function(t,i,e){},c3a6:function(t,i,e){"use strict";e("68ef"),e("09fe")},ccc3:function(t,i,e){},da3c:function(t,i,e){"use strict";e("68ef"),e("f319")},f319:function(t,i,e){}}]);
//# sourceMappingURL=chunk-4d977f40.9ace04a1.js.map